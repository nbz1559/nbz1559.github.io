<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SaturnV</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="website.ico">
</head>
<body>
<div class="container">
    <aside class="sidebar">
        <h2>SaturnV</h2>
        <nav>
            <ul>
                <li><a href="index.html">Main</a></li>
                <li><a href="lua.html">Lua Documentation</a></li>
                <li><a href="tos.html">Terms of Service</a></li>
                <li><a href="premium.html">Premium</a></li>
                <li><a href="#" id="siderbardownload">Download</a></li>
                <li><a href="#" id="sidebardiscord">Discord (Support)</a></li>
                <li><a href="info.html">Other</a></li>
            </ul>
        </nav>
    </aside>

    <main class="main-content">
        <h2>Main</h2>
        <div class="card-container">
            <div class="card">
                <h3>Online</h3>
                <p>Status</p>
            </div>
            <div class="card">
                <h3>11.4.4</h3>
                <p>Version</p>
            </div>
        </div>

        <div class="columns">
            <div class="column card" id="changelog-column">
                <h3>Changelog</h3>
                <div class="card-content">
                    <div class="sub-card">Loading...</div>
                </div>
            </div>
            <div class="column card" id="announcements-column">
                <h3>Announcements</h3>
                <div class="card-content">
                    <div class="sub-card">Loading...</div>
                </div>
            </div>
        </div>
    </main>
</div>

<script>
    document.getElementById("siderbardownload").addEventListener("click", async function() {
        const btn = this;
        const originalText = btn.textContent;
        btn.disabled = true;

        try {
            const response = await fetch("https://api.github.com/repos/nbz1559/SaturnV/releases/latest");
            if (!response.ok) throw new Error("Network error");

            const data = await response.json();
            let downloadUrl = "#";
            if (Array.isArray(data.assets) && data.assets.length > 0) {
                downloadUrl = data.assets[0].browser_download_url;
            } else {
                throw new Error("No assets found");
            }
            window.location.href = downloadUrl;
        } catch (err) {
            console.error(err);
            btn.textContent = "Failed to fetch release. Try again.";
            setTimeout(() => {
                btn.textContent = originalText;
            }, 3000);
        } finally {
            btn.disabled = false;
        }
    });

    document.getElementById("sidebardiscord").addEventListener("click", async function(e) {
        e.preventDefault();
        const btn = this;
        btn.disabled = true;

        try {
            const response = await fetch("https://saturnv-server.nathanielmcnair3.workers.dev/discordinvite");
            if (!response.ok) throw new Error(`Network error: ${response.status}`);

            const data = await response.json();
            if (data.success && data.message) {
                window.open(data.message, "_blank");
            } else {
                throw new Error("Invalid server response");
            }
        } catch (err) {
            console.error(err);
            alert("Failed to fetch Discord invite. Try again.");
        } finally {
            btn.disabled = false;
        }
    });

    function updateColumn(columnId, staticData, emptyMessage = "No items found.") {
    const column = document.getElementById(columnId);
    const content = column.querySelector('.card-content');
    content.innerHTML = '<div class="sub-card">Loading...</div>';

    try {
        if (Array.isArray(staticData) && staticData.length > 0) {
            content.innerHTML = '';

            staticData.forEach(groupStr => {
                groupStr = groupStr.replace(/^\{|\}$/g, '');
                const lines = groupStr.split(',');

                const groupDiv = document.createElement('div');
                groupDiv.className = 'sub-card';

                lines.forEach(line => {
                    const p = document.createElement('p');
                    p.textContent = line.trim();
                    groupDiv.appendChild(p);
                });

                content.appendChild(groupDiv);
            });
        } else {
            content.innerHTML = `<div class="sub-card">${emptyMessage}</div>`;
        }
    } catch (err) {
        console.error(err);
        content.innerHTML = `<div class="sub-card">Failed to render data.</div>`;
    }
}
const updates = [
"{11.3.0 (Legacy) 1.7 (Enhanced), Added World > Inhabitants > Oblivious NPCS, Added Game > Info Overlay > Location, Added SaturnV > Settings > Appearance > Info Overlay, Moved SaturnV > Settings > Appearance > Colours > Info Overlay to the new Info Overlay Settings Submenu, Added a new script “Custom Notifications” to the lua repository, Fixed some minor bugs, Fixed when loading a profile some states not apart of the profile were still on, Made notifications sent by the menu disappear faster}",

"{11.2.0 (Legacy) 1.6 (Enhanced), Re-added Self > Glue To Seat, Added Vehicle > Leave Engine On When Exiting, Added Vehicle > Lights & Signals, Added Vehicle > Los Santos Customs > Settings > Auto Register Vehicles, Added Vehicle > Los Santos Customs > Settings > Auto Register Spawned Vehicles, Added World > Teleportation > Saved Places > Save Waypoint Position, Added World > Teleportation > Bail Switch, Added Game > Alarms, Moved textures more to the right, Fixed an issue with beacons for places to teleport being on even if the command isnt selected}",

"{11.1.7 (Legacy) 1.5 (Enhanced), Added Vehicle > Spawner > Spawn At: Current Position or Closest Road, Added Vehicle > Passengers, Added World > Teleportation > Short Distances > Up, Added World > Teleportation > Short Distances > Down, Added World > Inhabitants > Vehicles > Traffic > Vehicle Manager > Launch Forward, Renamed World > NPCS to World > Inhabitants, Fixed Vehicle > Movement > Max Speed being set to 1944 instead of 540 by default (It goes back to normal if you change its value) and made it so if your game measurement system is set to KPH, then it will change your max speed in KPH, and MPH in MPH., Fixed Vehicle > Los Santos Customs > <vehicle> > Change Display Name only changing the name for one frame, Fixed some bugs}",

"{11.1.3 (Legacy) 1.4 (Enhanced), Added World > Atmosphere > Clock > Use Freemode Time, Added World > Atmosphere > Clock > Speed, Added Game > Info Overlay > Playing Time, Added Game > Info Overlay > Time Since Last Death, Added Game > Info Overlay > Time Since Last Arrest, Fixed Game > Info Overlay > FPS Showing an incorrect value when using a character's special ability and made it so it only updates every 300ms so you can actually read the frame rate., Fixed the entirety of “Self” disappearing if you tried to register a vehicle that does not exist in Vehicle > Los Santos Customs, Fixed Vehicle > Movement > Max Speed not allowing you to set your speed over 540, Made it so it tells you what your current vehicle is in Los Santos Customs, and also draws a beacon the vehicle that is selected in the menu, Made it so in World > Teleportation > Saved Places, when a place is selected a beacon will be drawn to it, Did the same thing as above for IPLS, Made smooth scrolling adjust for your frame rate, instead of being too slow or too fast because it was fixed for 60fps}",

"{11.0.0 (Legacy) 1.3 (Enhanced), Added World > Draw Beacon To… > Include Dead NPCS, Added SaturnV > Quick Alt + F4, Improved Vehicle > Los Santos Customs, Renamed World > Beacon Manager to Draw Beacon To…, Moved Game > Info Overlay > Cops > Draw Beacon To Nearest Cop to World > Draw Beacon To…, Replaced World > Draw Beacon To… > Beacon Type with a text slider, Made beacons draw to inhabitants regardless if they are in a vehicle or not, Added minor UI changes, Added a detection if the process is invalid, eg your running SaturnV legacy in GTA enhanced, the menu wont run and your gta will shut in 5 seconds, Readded online checks, will do the same as above}",

"{10.9.2 (Legacy) 1.1 (Enhanced), Fixed no value being set when entering a value on sliders via the text box, Made Vehicle > Bulletproof Tires fix your tires when toggled on}",
];


const announcements = [
"{24/11/2025 07:51:37pm, Gave the website a refresh}",
"{23/11/2025 09:41:28pm, Added all the updates under changelog}",
"{23/11/2025 08:16:39pm, Released Website}"
]
    updateColumn('changelog-column', updates, 'No changelog found.');
    updateColumn('announcements-column', announcements, 'No announcements yet.');
</script>
</body>
<footer class="footer-bar">
    &copy; 2025 SaturnV Menu. All rights reserved.
</footer>
</html>